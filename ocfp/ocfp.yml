---
meta:
  ocfp:
    env:
      scale: (( grab params.env.scale || "dev" ))

    vault:
      tf: (( concat genesis.secrets_mount "tf/" genesis.vault_env ))

    certs:
      trusted:
        - (( vault genesis.secrets_mount "certs/org:ca" )) # Organization CA, if exists
        - (( vault genesis.secrets_mount "certs/dbs:ca" )) # External Databases CA

    concourse:
      ip: (( vault meta.ocfp.vault.tf "/bosh/iaas/subnets/ocfp/0/ips/mgmt/reserved:concourse_ip" ))

params:
  concourse_network:   (( concat genesis.env "-concourse" ))
  concourse_vm_type:   (( concat "concourse-" meta.ocfp.env.scale ))
  concourse_disk_type: (( concat "concourse-" meta.ocfp.env.scale ))

  worker_vm_type:      "concourse-worker"
